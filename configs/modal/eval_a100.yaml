# Modal A100 Eval Set - FINAL TEST - ONE SHOT ONLY!
# ⚠️ WARNING: DO NOT USE THIS UNTIL TRAINING AND TUNING COMPLETE! ⚠️

data:
  dataset: tuh_eeg
  data_dir: /data/edf/eval             # Modal S3 mount - EVAL SET - 45 patients
  cache_dir: /results/cache/eval        # Modal persistent volume
  sampling_rate: 256
  n_channels: 19
  window_size: 60
  stride: 10
  num_workers: 8
  pin_memory: true
  persistent_workers: true
  validation_split: 0.0                 # No split - use entire eval set
  use_balanced_sampling: true          # CRITICAL: Use positive-aware sampling

preprocessing:
  montage: "10-20"
  bandpass: [0.5, 120]
  notch_freq: 60
  normalize: true
  use_mne: true

model:
  name: seizure_detector
  encoder:
    stages: 4
    channels: [64, 128, 256, 512]
    kernel_size: 5
    downsample_factor: 2
  rescnn:
    n_blocks: 3
    kernel_sizes: [3, 5, 7]
    dropout: 0.1
  mamba:
    n_layers: 6
    d_model: 512
    d_state: 16
    conv_kernel: 5
    dropout: 0.1
  decoder:
    stages: 4
    kernel_size: 4

postprocessing:
  hysteresis:
    tau_on: 0.86      # LOCKED from dev tuning - DO NOT CHANGE
    tau_off: 0.78     # LOCKED from dev tuning - DO NOT CHANGE
  morphology:
    opening_kernel: 11
    closing_kernel: 31
  duration:
    min_duration_s: 3.0
    max_duration_s: 600.0
  events:
    tau_merge: 2.0
    confidence_method: mean

training:
  epochs: 0                             # NO TRAINING - evaluation only
  batch_size: 128                      # A100 can handle larger batches for inference
  mixed_precision: true

evaluation:
  metrics: [taes, sensitivity, specificity, auroc]
  fa_rates: [10, 5, 2.5, 1]
  mode: final                          # Final evaluation mode
  generate_submission: true            # For epilepsybenchmarks.com

experiment:
  name: modal_eval_FINAL_$(date +%Y%m%d_%H%M%S)
  description: "⚠️ FINAL EVALUATION on Modal A100 - NO RETRAINING AFTER THIS!"
  seed: 42
  device: cuda
  output_dir: /results/FINAL_EVAL
  cache_dir: /results/cache/eval
  log_level: INFO
  checkpoint_path: /results/tusz_a100_100ep/checkpoints/best.pt  # Final model from train_a100.yaml

logging:
  log_every_n_steps: 50
  tensorboard: true
  save_predictions: true               # Save all predictions for analysis

# ⚠️ REMINDER: Running this config means you're done!
# No parameter adjustments after seeing these results!
# This is your FINAL submission performance.